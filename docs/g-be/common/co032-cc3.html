<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-g-be/common/co032-cc3" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">Cloud SW 아키텍처 패턴:Performance Patterns | DoDo(도도)의 개발 블로그</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://dosimpact.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://dosimpact.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://dosimpact.github.io/docs/g-be/common/co032-cc3"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="keywords" content="frontend, 취업가이드, 개발자 취업, 포트폴리오, 코테 공부, 개발자 현실, 프론트 개발자"><meta data-rh="true" name="google-site-verification" content="Ov_hk6LqaaE5KiwXnqF2gTKwPxBE3qG5Zr3o5UWZXc8"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Cloud SW 아키텍처 패턴:Performance Patterns | DoDo(도도)의 개발 블로그"><meta data-rh="true" name="description" content="- Cloud SW 아키텍처 패턴:Performance Patterns"><meta data-rh="true" property="og:description" content="- Cloud SW 아키텍처 패턴:Performance Patterns"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://dosimpact.github.io/docs/g-be/common/co032-cc3"><link data-rh="true" rel="alternate" href="https://dosimpact.github.io/docs/g-be/common/co032-cc3" hreflang="en"><link data-rh="true" rel="alternate" href="https://dosimpact.github.io/docs/g-be/common/co032-cc3" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="DoDo(도도)의 개발 블로그 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="DoDo(도도)의 개발 블로그 Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-WKPFKPLJJC"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-WKPFKPLJJC",{anonymize_ip:!0})</script><link rel="stylesheet" href="/assets/css/styles.0ceb0325.css">
<link rel="preload" href="/assets/js/runtime~main.192d71a1.js" as="script">
<link rel="preload" href="/assets/js/main.214591fe.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">DoDo</b></a><a class="navbar__item navbar__link" href="/docs/category/javascript">👒Front End</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/category/common">🛰️Backend End</a><a class="navbar__item navbar__link" href="/docs/category/sideproject-3">🚧DevOps</a><a class="navbar__item navbar__link" href="/docs/category/아웃풋">🔅Soft Skill</a><a class="navbar__item navbar__link" href="/blog">📝Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/dosimpact" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/category/common">Common</a><button aria-label="Toggle the collapsible sidebar category &#x27;Common&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/g-be/common/co001-sd1">[시스템디자인&amp;인터뷰] 1.확장 가능한 시스템 설계</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/g-be/common/co030-cc1">Cloud SW 아키텍처 패턴:소개</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/g-be/common/co031-cc2">Cloud SW 아키텍처 패턴:Scalability Patterns</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/g-be/common/co032-cc3">Cloud SW 아키텍처 패턴:Performance Patterns</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/g-be/common/co033-cc4">Cloud SW 아키텍처 패턴:Extensibility Patterns</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/g-be/common/co034-cc5">Cloud SW 아키텍처 패턴:Extensibility Patterns</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/docs/category/nodejs">Node.js</a><button aria-label="Toggle the collapsible sidebar category &#x27;Node.js&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/g-be/node/co001">nodemon typescript node.js 개발환경 구축</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/docs/category/kafka">Kafka</a><button aria-label="Toggle the collapsible sidebar category &#x27;Kafka&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/g-be/kafka/ka001">초보자를 위한 kafka-1 소개</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/g-be/kafka/ka002">초보자를 위한 kafka-2 주요개념</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/g-be/kafka/ka003">kafka install with docker</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/g-be/kafka/ka004">초보자를 위한 kafka-3 CLI</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/g-be/kafka/ka005">kafka example with nestjs, python</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/docs/category/nestjs">NestJS</a><button aria-label="Toggle the collapsible sidebar category &#x27;NestJS&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/g-be/nest/ne001">NestJS 시작</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/g-be/nest/ne002">NestJS env 설정</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/g-be/nest/ne003-typeorm-01">NestJS PostgreSQL 설치</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/g-be/nest/ne003-typeorm-02">NestJS TypeOrmModule</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/g-be/nest/ne003-typeorm-03">NestJS TypeORM Entity 1</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/common"><span itemprop="name">Common</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Cloud SW 아키텍처 패턴:Performance Patterns</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Cloud SW 아키텍처 패턴:Performance Patterns</h1><ul><li><a href="#cloud-sw-%EC%95%84%ED%82%A4%ED%85%8D%EC%B2%98-%ED%8C%A8%ED%84%B4performance-patterns">Cloud SW 아키텍처 패턴:Performance Patterns</a><ul><li><a href="#performance-patterns-for-data-intensive-systems">Performance Patterns for Data Intensive Systems</a></li><li><a href="#map-reduce-pattern">Map Reduce Pattern</a><ul><li><a href="#%EB%8C%80%EC%9A%A9%EB%9F%89-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%B2%98%EB%A6%AC%EC%9D%98-%EB%AC%B8%EC%A0%9C%EC%A0%90">대용량 데이터 처리의 문제점</a></li><li><a href="#mapreduce-usecase">MapReduce UseCase</a></li><li><a href="#mapreduce-%EA%B8%B0%EB%B3%B8-%EA%B5%AC%EC%A1%B0">MapReduce 기본 구조</a></li><li><a href="#mapreduce-%EC%98%88%EC%8B%9C">MapReduce 예시</a></li><li><a href="#%EC%95%84%ED%82%A4%ED%85%8D%EC%B2%98-%EA%B5%AC%EC%A1%B0">아키텍처 구조</a></li><li><a href="#%EC%9D%B4%EC%A0%90">이점</a></li><li><a href="#%EC%8B%A4%ED%8C%A8-%EB%B0%8F-%EB%B3%B5%EA%B5%AC-%EC%A0%84%EB%9E%B5">실패 및 복구 전략</a></li><li><a href="#%EA%B3%A0%EB%A0%A4%EC%A0%90">고려점</a></li></ul></li><li><a href="#saga-pattern">Saga Pattern</a><ul><li><a href="#%EB%AC%B8%EC%A0%9C-%EB%B0%8F-%ED%95%B4%EA%B2%B0">문제 및 해결</a></li><li><a href="#saga-pattern-%EA%B8%B0%EB%B3%B8-%EA%B5%AC%EC%A1%B0">Saga Pattern 기본 구조</a></li><li><a href="#%EC%98%88%EC%8B%9C---%EC%BD%98%EC%84%9C%ED%8A%B8-%ED%8B%B0%EC%BC%93-%ED%8C%90%EB%A7%A4-%EC%84%9C%EB%B9%84%EC%8A%A4">예시 - 콘서트 티켓 판매 서비스</a></li><li><a href="#%EC%98%88%EC%8B%9C---%EC%BD%98%EC%84%9C%ED%8A%B8-%ED%8B%B0%EC%BC%93-%ED%8C%90%EB%A7%A4-%EC%84%9C%EB%B9%84%EC%8A%A4---2">예시 - 콘서트 티켓 판매 서비스 - 2</a></li><li><a href="#saga-pattern-%ED%8A%B9%EC%A7%95">Saga Pattern 특징</a></li></ul></li><li><a href="#transactional-outbox-pattern">Transactional Outbox Pattern</a><ul><li><a href="#%EB%AC%B8%EC%A0%9C%EC%A0%90">문제점</a></li><li><a href="#%ED%95%B4%EA%B2%B0">해결</a></li></ul></li><li><a href="#materialized-view-pattern">Materialized View Pattern</a><ul><li><a href="#%EB%AC%B8%EC%A0%9C%EC%A0%90-1">문제점</a></li></ul></li><li><a href="#cqrs-pattern">CQRS Pattern</a></li><li><a href="#event-sourcing-pattern">Event Sourcing Pattern</a></li></ul></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="performance-patterns-for-data-intensive-systems">Performance Patterns for Data Intensive Systems<a href="#performance-patterns-for-data-intensive-systems" class="hash-link" aria-label="Direct link to Performance Patterns for Data Intensive Systems" title="Direct link to Performance Patterns for Data Intensive Systems">​</a></h2><hr><p>데이터 집약 시스템을 위한 성능 패턴을 도입으로 얻는 이점은 무엇일까?  </p><ul><li>아키텍처 변경없이 대용량 데이터 처리  </li><li>분산트랙젝션 가능 (ACID 유지)  </li></ul><br><h2 class="anchor anchorWithStickyNavbar_LWe7" id="map-reduce-pattern">Map Reduce Pattern<a href="#map-reduce-pattern" class="hash-link" aria-label="Direct link to Map Reduce Pattern" title="Direct link to Map Reduce Pattern">​</a></h2><hr><h3 class="anchor anchorWithStickyNavbar_LWe7" id="대용량-데이터-처리의-문제점">대용량 데이터 처리의 문제점<a href="#대용량-데이터-처리의-문제점" class="hash-link" aria-label="Direct link to 대용량 데이터 처리의 문제점" title="Direct link to 대용량 데이터 처리의 문제점">​</a></h3><p>대용량 데이터 세트 처리의 문제점은 데이터 처리를 위해서 수백~수천 대의 머신에 분산처리 시켜야 하는 점이다.  </p><ul><li>데이터 병렬화, 데이터 분산 배포, 결과 추합</li><li>실행 예약, 실패 처리, 복구 문제</li><li>많은 처리 소스 코드 및 인프라 구성  </li></ul><p>맵리듀스 패턴을 사용하면, 아키텍처의 변경없이 많은 양의 데이터를 처리할 수 있는 시스템이 구성된다.  </p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="mapreduce-usecase">MapReduce UseCase<a href="#mapreduce-usecase" class="hash-link" aria-label="Direct link to MapReduce UseCase" title="Direct link to MapReduce UseCase">​</a></h3><ul><li>머신러닝</li><li>로그 파일 필터 및 분석</li><li>역색인 구성</li><li>웹링크 그래프 순회</li><li>분산 정렬  </li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="mapreduce-기본-구조">MapReduce 기본 구조<a href="#mapreduce-기본-구조" class="hash-link" aria-label="Direct link to MapReduce 기본 구조" title="Direct link to MapReduce 기본 구조">​</a></h3><p><img loading="lazy" src="/assets/images/co14-5bdfedef61852285d5b13909d8e8a055.png" width="1934" height="936" class="img_ev3q">  </p><p>Input data: key-value 쌍으로 구성된 데이터를 입력  </p><ol><li>Map : Map를 통과하면 중간 key-value쌍이 나오게 된다.  </li><li>intermediate data : Map 중간 key-value 결과물 </li><li>Reduce : Reduce 함수에서 중간 key-value를 grouping하고(정렬) Reduce 로직 수행 후 최종 데이터를 출력한다.
Output data : 최종데이터   </li></ol><ul><li>사실상 위 구조만 봤을때는 잘 이해되지 않는다.    </li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="mapreduce-예시">MapReduce 예시<a href="#mapreduce-예시" class="hash-link" aria-label="Direct link to MapReduce 예시" title="Direct link to MapReduce 예시">​</a></h3><p><img loading="lazy" src="/assets/images/co15-c9288c1923792c71ec1dbf9a71f83812.png" width="1922" height="938" class="img_ev3q">  </p><p>Goal : 수많은 파일들을 분석해서, 특정 단어의 수를 카운트 하자.  </p><p>Input data: key는 파일이름, value는 파일 내용물   </p><ol><li>Map : 각각의 text file을 대상으로 단어의 갯수들을 출력한다. 이는 key-value쌍으로 출력 가능.    </li><li>intermediate data : 각 파일의 단어수가 적힌 key-value 데이터 셋 </li></ol><p><img loading="lazy" src="/assets/images/co17-f22a541cbdfb2e1150782b2ab241ea26.png" width="1572" height="908" class="img_ev3q"><br>
<!-- -->3. Reduce : key값이 단어이므로, 단어순으로 정렬를 먼저 한다. </p><ul><li>그리고 각 단어들의 갯수를 추합하여 최종 데이터를 출력한다.      </li><li>*리듀스 함수를 통과시키는데 key에 대해서 반복자를 돌린다. 중간키에 대한 값이 많아서 메모리에 한번에 로드 불가능   </li></ul><p>Output data : key-value(단어,갯수)의 리스트  </p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="아키텍처-구조">아키텍처 구조<a href="#아키텍처-구조" class="hash-link" aria-label="Direct link to 아키텍처 구조" title="Direct link to 아키텍처 구조">​</a></h3><p><img loading="lazy" src="/assets/images/co16-972bc937b9984ef9d989aceb121a39ae.png" width="1926" height="906" class="img_ev3q">  </p><p>크게 3가지의 컴포넌트로 구성된다. 마스터노드, 맵워커, 리듀스 워커  </p><p>1.마스터 노드 </p><ul><li>전체 MapReduce 작업 예약 및 컨트롤  </li><li>전체 데이터를 청크단위로 나누어서, Map Workder들에게 할당한다. (실제 데이터 주는것이 아닌 임무를 부여)  </li></ul><p>2.Map Workers  </p><ul><li>Map 함수를 실행하는 수백 ~ 수천개의 컴퓨터  </li><li>그냥 데이터를 저장하지 않고, Region을 분리해서 저장한다.  </li><li>Region = hash(key) mod R : 을 통해서 어떤 Region에 저장할지 결정 가능하다.  </li></ul><p>3.Reduce Workers</p><ul><li>마스터는 각 Region을 담당하고 있는 워커에게 작업을 분배한다.</li><li>리듀스 워커가 데이터를 읽어간다. </li><li>키를 그룹 및 정렬하는 과정 (셔플링) &gt; Reduce 연산을 수행  </li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="이점">이점<a href="#이점" class="hash-link" aria-label="Direct link to 이점" title="Direct link to 이점">​</a></h3><ul><li>같은 SW아키텍처를 재활용할 수 있다. Map,Reduce함수만 바꾸면 된다. </li><li>테스크의 스케일링이 가능.  </li><li>많은 워커에게 평행하게 작업 분배 가능    </li><li>짧은 시간안에 대용량의 데이터를 처리할 수 있음.  </li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="실패-및-복구-전략">실패 및 복구 전략<a href="#실패-및-복구-전략" class="hash-link" aria-label="Direct link to 실패 및 복구 전략" title="Direct link to 실패 및 복구 전략">​</a></h3><ul><li>마스터가 리듀스 워커들을 관찰하며, 실패한 작업을 다시 다른 워커에게 할당</li><li>맵 워커가 실패한 경우도 다른 워커에게 작업을 할당하며 이때 바뀐 중간 key-value 값위치도 리듀스워커에게 알려야한다.  </li><li>마스터 워커가 장애날 확률은 적지만, 작업에 대한 상태를 스냅샷을 두거나 백업 마스터를 둔다.  </li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="고려점">고려점<a href="#고려점" class="hash-link" aria-label="Direct link to 고려점" title="Direct link to 고려점">​</a></h3><ul><li>직접 Map,Reduce 아키텍처를 구성할 일은 없다. </li><li>오픈소스/클라우드 서비스 이용한다.  </li><li>클라우드 환경을 이용해서 필요한 만큼 컴퓨터를 대여하고 반납한다.  <ul><li>ㄴ ( on demand | on scheduled Batch )</li></ul></li><li>시스템은 구성을 신경스지 않고, 비즈니스에 집중 가능하다.<ul><li>ㄴ 데이터모델링, map-reduce 모델링, execution parameters 정의 ..등  </li></ul></li></ul><br><h2 class="anchor anchorWithStickyNavbar_LWe7" id="saga-pattern">Saga Pattern<a href="#saga-pattern" class="hash-link" aria-label="Direct link to Saga Pattern" title="Direct link to Saga Pattern">​</a></h2><hr><h3 class="anchor anchorWithStickyNavbar_LWe7" id="문제-및-해결">문제 및 해결<a href="#문제-및-해결" class="hash-link" aria-label="Direct link to 문제 및 해결" title="Direct link to 문제 및 해결">​</a></h3><p><img loading="lazy" src="/assets/images/co28-dc6f6e44d4ccd3b8c18e32c91c3c53b1.png" width="1330" height="744" class="img_ev3q"></p><p>MSA는 빠른 엔지니어링 속도, 확장성 등 이점이 있다.   </p><ul><li>한가지 중요한 원칙이 마이크로 서비스 하나당 DB가 하나여야 한다.    </li><li>만약에 여러 팀이 DB커넥션을 맺으면, 모든 변경사항에 대해서 합의가 필요하다.  </li><li>이는 마이크로 서비스들이 database를 공유하는것은 MSA안티 패턴이다.  </li></ul><p>하지만 서비스 마다 DB로 분리하는 순간 ACID 트랜잭션 이라는 특성을 잃게 된다.    </p><ul><li>*리마인드) 트랜젝션 : 외부 옵저버에 단일 작업으로 표시돼야 하는 작업의 시퀀스  </li><li>분산 환경에서 데이터의 일관성을 유지하는 방법이 saga패턴이다.  </li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="saga-pattern-기본-구조">Saga Pattern 기본 구조<a href="#saga-pattern-기본-구조" class="hash-link" aria-label="Direct link to Saga Pattern 기본 구조" title="Direct link to Saga Pattern 기본 구조">​</a></h3><p><img loading="lazy" src="/assets/images/co29-677205930d44be927466d3d036d78b2b.png" width="1622" height="740" class="img_ev3q"></p><p>saga 패턴은 다음의 과정을 통해서 분산환경에서 ACID를 유지 힌다. </p><ul><li>local 트랜젝션1 을 수행하고 다음 서비스에서 트랜젝션 시퀀스를 이어 간다.  </li><li>그러다 만약 작업이 실패하면, 기존에 수행한 작업을 롤백하기 위한 과정이 있다.  </li><li>기존 작업에 대한 보상 작업(보상 트랙젝션) 이라고 한다.  </li><li>*트랜젝션 시퀀스가 성공할때까지 위 과정을 반복한다.  </li></ul><p>saga 패턴 구현방법  </p><ol><li>Orchestrator Pattern : 오케스트레이터 서버로 트렉젝션 시퀀스 및 보상 관리</li><li>Choreography Pattern : 메시지 브로커로 트렉젝션 시퀀스 및 보상 관리</li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="예시---콘서트-티켓-판매-서비스">예시 - 콘서트 티켓 판매 서비스<a href="#예시---콘서트-티켓-판매-서비스" class="hash-link" aria-label="Direct link to 예시 - 콘서트 티켓 판매 서비스" title="Direct link to 예시 - 콘서트 티켓 판매 서비스">​</a></h3><p>요구사항 </p><ul><li>행사 티켓 및 티켓 전용 좌석을 예약    </li><li>블랙리스트 상 유저인지 체크 </li><li>결제금액을 받았는지 체크 </li><li>고객 1명당 1개 좌석인지 체크</li></ul><p><img loading="lazy" src="/assets/images/co30-6136824c11a5dd44baff8186ababebfb.png" width="1534" height="932" class="img_ev3q"></p><p><em>보상 트렌젝션 : pending상태를 원래상태로 되돌리는 트렌젝션<br></em>Pivot Operation : pending상태를 성공상태로 바꾸는 작업들  </p><p>1.Order Service : </p><ul><li>좌석예약 상태로 DB를 업데이트 (pending) 후 이어서 진행  </li><li>pending 상태이므로, 다른 사용자가 같은 자리를 예약 시도 -&gt; 실패 및 retry 안내   </li><li>만약 트랜젝션이 실패하면 다른 사용자가 이용 가능    </li></ul><p>2.Security Service : 사용자가 유효한지 체크  </p><ul><li>만약 블랙리스트라면 rollback ( &gt; Order Service 보상 )</li><li>아니라면 이어서 진행</li></ul><p>3.Billing Service : 3rd party에 결제 시도  </p><ul><li>결제 오류라면 rollback ( &gt; Order Service 보상 )</li><li>아니라면 DB를 업데이트 (pending) 및 결제 (pending) 후 이어서 진행</li></ul><p>4.Reservation Service : 3rd party 좌석 예매 시스템  </p><ul><li>만약 누군가가 이미 예매했다면 rollback ( &gt; Billing Service 보상 &gt; Order Service 보상 )</li><li>아니라면 좌석 티켓 예약 성공 및 DB업데이트 (reserved)  </li></ul><p><img loading="lazy" src="/assets/images/co31-f0b843312862c4d030e9260fb9fb89c2.png" width="1598" height="926" class="img_ev3q"></p><p>5.Pivot Operation </p><ul><li>Billing Servce : pending &gt; 사용자에게 결제 요청 API &gt; 성공 &gt; charged</li><li>Order Service : panding &gt; purchased </li><li>Email Service : 결제성공알람  </li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="예시---콘서트-티켓-판매-서비스---2">예시 - 콘서트 티켓 판매 서비스 - 2<a href="#예시---콘서트-티켓-판매-서비스---2" class="hash-link" aria-label="Direct link to 예시 - 콘서트 티켓 판매 서비스 - 2" title="Direct link to 예시 - 콘서트 티켓 판매 서비스 - 2">​</a></h3><p>위 과정을 메시지 브로커를 통해서 작동하도록 로직을 구성한다.  </p><ul><li>메시지 브로커를 사용하면 문제점이 있다.  </li><li>ACID가 지켜지지 않는데, 이는 다음패턴에서 해결  </li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="saga-pattern-특징">Saga Pattern 특징<a href="#saga-pattern-특징" class="hash-link" aria-label="Direct link to Saga Pattern 특징" title="Direct link to Saga Pattern 특징">​</a></h3><ul><li>성공,실패 모두 오퍼레이션이 있다.  </li><li>실패하는 경우 롤백 오퍼레이션 (보상 트렌젝션)    </li><li>성공하는 경우 피봇 오퍼레이션  </li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="transactional-outbox-pattern">Transactional Outbox Pattern<a href="#transactional-outbox-pattern" class="hash-link" aria-label="Direct link to Transactional Outbox Pattern" title="Direct link to Transactional Outbox Pattern">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="문제점">문제점<a href="#문제점" class="hash-link" aria-label="Direct link to 문제점" title="Direct link to 문제점">​</a></h3><p><img loading="lazy" src="/assets/images/co32-b2d815bafb29facc335e6501c320d930.png" width="1474" height="676" class="img_ev3q">
구인구직 추천서비스를 예로들면  </p><ul><li>사용자가 회원가입 이후, 신규 유저 메시지를 보내야 한다.  </li><li>DB와 메시지 브로커는 단일 트렉젝션이 아니므로, 충분히 신규 회원가입의 메시지를 못받을 수 있다.  </li><li>특히나 결제관련된 사항이라면, 영원히 결제 pending 일 수 있다.  </li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="해결">해결<a href="#해결" class="hash-link" aria-label="Direct link to 해결" title="Direct link to 해결">​</a></h3><p>단일 트랜젝션으로 만드는 방법 </p><p>[ 문제점 - outbox service가 메시지를 두번 보내는 경우 ]</p><p>메시지 중복이 되더라도 괜찮은 경우 </p><ul><li>멱등 연산인 경우</li><li>결제처럼 중복이 일어나면 안되는 경우 - 멱등연산으로 만들면된다. </li><li>*결제 ID를 부여</li></ul><p>[ 문제점 - atomic transaction을 DB에서 지원하지 않는 경우 nosql ]</p><ul><li>document model에 outbox 데이터 자체를 추가하면 된다. </li></ul><p>[ 문제점 - 이벤트의 순서 ]</p><ul><li>outbox테이블에 시퀀스 ID를 부여하는 것 </li><li>항상 ID가 낮은 순서대로 메시지를 읽어서 처리해야 한다.  </li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="materialized-view-pattern">Materialized View Pattern<a href="#materialized-view-pattern" class="hash-link" aria-label="Direct link to Materialized View Pattern" title="Direct link to Materialized View Pattern">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="문제점-1">문제점<a href="#문제점-1" class="hash-link" aria-label="Direct link to 문제점" title="Direct link to 문제점">​</a></h3><p>Raw Data Table이 업데이트 되면, View 테이블을 즉시 혹은 스케쥴링된 시간에 업데이트 가능하다.</p><p>[ 예시 ]<!-- -->
온라인 교옥 플랫폼</p><p>[ 방법 ]<!-- -->
db 테이블로 저장
redis 로 저장</p><p>[ 코멘트 ]<!-- -->
DB조회가 느린 경우 말고도, 서드파티 API가느린 경우에도 사용할 수 있겠다. </p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="cqrs-pattern">CQRS Pattern<a href="#cqrs-pattern" class="hash-link" aria-label="Direct link to CQRS Pattern" title="Direct link to CQRS Pattern">​</a></h2><p>Command and Query Responsibility Segregation </p><p>[ 트레이드 오프 ]<!-- -->
복잡한 시스템</p><p>[ 사례 ]</p><p>후기를 읽는 서비스</p><ul><li>읽기에 최적화되어있다. </li><li>특별한 비즈니스 로직 유효성 검사 등 필요없고, 퍼블릭에 공개가능한 데이터만 존재한다.  </li></ul><p>리뷰는 비교적 실시간 업데이트를 진행하고
상품의 평균 리뷰는 스케쥴링을 통해 제공 </p><p>[ CQRS + Materialized View ]</p><ol><li>Message Queue 데이터 싱크</li><li>Cloud Function 데이터 싱크</li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="event-sourcing-pattern">Event Sourcing Pattern<a href="#event-sourcing-pattern" class="hash-link" aria-label="Direct link to Event Sourcing Pattern" title="Direct link to Event Sourcing Pattern">​</a></h2></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/g-be/0-common/co032-cc3.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/g-be/common/co031-cc2"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Cloud SW 아키텍처 패턴:Scalability Patterns</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/g-be/common/co033-cc4"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Cloud SW 아키텍처 패턴:Extensibility Patterns</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#performance-patterns-for-data-intensive-systems" class="table-of-contents__link toc-highlight">Performance Patterns for Data Intensive Systems</a></li><li><a href="#map-reduce-pattern" class="table-of-contents__link toc-highlight">Map Reduce Pattern</a><ul><li><a href="#대용량-데이터-처리의-문제점" class="table-of-contents__link toc-highlight">대용량 데이터 처리의 문제점</a></li><li><a href="#mapreduce-usecase" class="table-of-contents__link toc-highlight">MapReduce UseCase</a></li><li><a href="#mapreduce-기본-구조" class="table-of-contents__link toc-highlight">MapReduce 기본 구조</a></li><li><a href="#mapreduce-예시" class="table-of-contents__link toc-highlight">MapReduce 예시</a></li><li><a href="#아키텍처-구조" class="table-of-contents__link toc-highlight">아키텍처 구조</a></li><li><a href="#이점" class="table-of-contents__link toc-highlight">이점</a></li><li><a href="#실패-및-복구-전략" class="table-of-contents__link toc-highlight">실패 및 복구 전략</a></li><li><a href="#고려점" class="table-of-contents__link toc-highlight">고려점</a></li></ul></li><li><a href="#saga-pattern" class="table-of-contents__link toc-highlight">Saga Pattern</a><ul><li><a href="#문제-및-해결" class="table-of-contents__link toc-highlight">문제 및 해결</a></li><li><a href="#saga-pattern-기본-구조" class="table-of-contents__link toc-highlight">Saga Pattern 기본 구조</a></li><li><a href="#예시---콘서트-티켓-판매-서비스" class="table-of-contents__link toc-highlight">예시 - 콘서트 티켓 판매 서비스</a></li><li><a href="#예시---콘서트-티켓-판매-서비스---2" class="table-of-contents__link toc-highlight">예시 - 콘서트 티켓 판매 서비스 - 2</a></li><li><a href="#saga-pattern-특징" class="table-of-contents__link toc-highlight">Saga Pattern 특징</a></li></ul></li><li><a href="#transactional-outbox-pattern" class="table-of-contents__link toc-highlight">Transactional Outbox Pattern</a><ul><li><a href="#문제점" class="table-of-contents__link toc-highlight">문제점</a></li><li><a href="#해결" class="table-of-contents__link toc-highlight">해결</a></li></ul></li><li><a href="#materialized-view-pattern" class="table-of-contents__link toc-highlight">Materialized View Pattern</a><ul><li><a href="#문제점-1" class="table-of-contents__link toc-highlight">문제점</a></li></ul></li><li><a href="#cqrs-pattern" class="table-of-contents__link toc-highlight">CQRS Pattern</a></li><li><a href="#event-sourcing-pattern" class="table-of-contents__link toc-highlight">Event Sourcing Pattern</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.192d71a1.js"></script>
<script src="/assets/js/main.214591fe.js"></script>
</body>
</html>